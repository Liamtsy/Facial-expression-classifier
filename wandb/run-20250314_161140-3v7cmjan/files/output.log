/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torchvision/transforms/v2/_deprecated.py:42: UserWarning: The transform `ToTensor()` is deprecated and will be removed in a future release. Instead, please use `v2.Compose([v2.ToImage(), v2.ToDtype(torch.float32, scale=True)])`.Output is equivalent up to float precision.
  warnings.warn(
Calculated flattened size: 61440
/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
[33m[W 2025-03-14 16:11:41,728][0m Trial 0 failed with parameters: {'learning_rate': 0.00043760311975951633, 'dropout_rate': 0.47086903447760475, 'conv1_channels': 16, 'conv2_channels': 60, 'conv3_channels': 87, 'fc1_units': 167, 'batch_size': 32, 'conv1_kernel_size': 5, 'conv1_padding_size': 3, 'pool_kernel_size': 3, 'pool_stride_size': 2, 'conv2_kernel_size': 3, 'conv2_padding_size': 2, 'conv3_kernel_size': 7, 'conv3_padding_size': 1, 'activation': 'ReLU', 'optimizer': 'SGD', 'model_variant': 'deep', 'weight_decay': 0.0003617555776399951, 'momentum': 0.39669233904787965} because of the following error: RuntimeError('mat1 and mat2 shapes cannot be multiplied (32x14703 and 61440x167)').[0m
Traceback (most recent call last):
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/liamtsy/Desktop/Exchange_student/UCSC/Winter_2025/CMPM17-02/cmpm-17-final-project/main_optuna.py", line 348, in objective
    pred = model(image)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/liamtsy/Desktop/Exchange_student/UCSC/Winter_2025/CMPM17-02/cmpm-17-final-project/main_optuna.py", line 176, in forward
    x = self.fc1(x)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32x14703 and 61440x167)
[33m[W 2025-03-14 16:11:41,732][0m Trial 0 failed with value None.[0m
Traceback (most recent call last):
  File "/Users/liamtsy/Desktop/Exchange_student/UCSC/Winter_2025/CMPM17-02/cmpm-17-final-project/main_optuna.py", line 470, in <module>
    study.optimize(objective, n_trials=50)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/liamtsy/Desktop/Exchange_student/UCSC/Winter_2025/CMPM17-02/cmpm-17-final-project/main_optuna.py", line 348, in objective
    pred = model(image)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/liamtsy/Desktop/Exchange_student/UCSC/Winter_2025/CMPM17-02/cmpm-17-final-project/main_optuna.py", line 176, in forward
    x = self.fc1(x)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/liamtsy/cmpm17_venv/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32x14703 and 61440x167)
